# ==================== Python 版本要求 ====================
# Python版本要求: >=3.10（py3.10+）
# 兼容版本: Python 3.10, 3.11, 3.12, 3.13 及以上版本
# 建议开启虚拟环境以避免依赖冲突

# ==================== 容错策略 ====================
# 使用宽松的版本范围而非固定版本，最大化容错性和兼容性，避免依赖链冲突
# 所有依赖包版本均经过Python 3.10+兼容性验证
# 版本上限设置较为宽松，允许自动获取安全更新和bug修复
# 容错策略：使用 >= 而非 ==，允许小版本自动更新，提高系统稳定性
# 所有依赖均使用 >= 下限，< 上限的格式，确保兼容性和安全性

# ==================== 基础工具和类型支持 ====================
typing-extensions>=4.8.0,<5.0.0  # 类型提示支持，兼容Python 3.10+，向后兼容

# ==================== Web框架及其核心依赖 ====================
Flask>=3.0.0,<6.0.0  # Web框架，宽松版本范围允许小版本更新
Werkzeug>=3.0.0,<5.0.0  # Flask的核心依赖，放宽上限增加兼容性
Jinja2>=3.1.2,<4.0.0  # 模板引擎，稳定版本范围
itsdangerous>=2.1.2,<5.0.0  # 安全工具，放宽版本范围
click>=8.1.7,<10.0.0  # 命令行工具，宽松版本范围
blinker>=1.7.0,<4.0.0  # 信号库，放宽版本范围
flask-cors>=4.0.0,<6.0.0  # CORS支持，宽松版本范围
MarkupSafe>=2.1.0,<3.0.0  # Jinja2依赖，模板安全转义

# ==================== OpenAI SDK 及其依赖 ====================
openai>=1.12.0,<3.0.0  # OpenAI API客户端，兼容OpenRouter和DeepSeek API（流式响应支持）

# OpenAI SDK 的异步HTTP依赖
trio>=0.22.0,<1.0.0  # 异步框架，OpenAI SDK依赖，设置上限提高稳定性
httpx>=0.25.0,<2.0.0  # 异步HTTP客户端，放宽版本范围
httpx-sse>=0.4.0,<1.0.0  # SSE支持，OpenAI流式响应需要
h11>=0.14.0,<1.0.0  # HTTP/1.1协议实现，httpx依赖
sniffio>=1.3.0,<2.0.0  # 异步IO检测，trio依赖
anyio>=4.0.0,<5.0.0  # 异步IO抽象层，httpx/trio依赖

# ==================== 火山引擎方舟SDK（豆包模型） ====================
volcengine-python-sdk[ark]>=1.0.0,<2.0.0  # 火山引擎方舟SDK，用于豆包模型（Seedance等）

# ==================== Anthropic SDK（Minimax API 兼容） ====================
anthropic>=0.18.0,<1.0.0  # Anthropic SDK，用于 Minimax API（通过兼容层）

# ==================== HTTP请求库及其依赖 ====================
requests>=2.31.0,<4.0.0  # 同步HTTP客户端，放宽版本范围增加容错性
charset-normalizer>=3.3.0,<4.0.0  # 字符编码检测，requests依赖
idna>=3.4,<4.0  # 国际化域名支持，requests依赖
urllib3>=2.0.0,<3.0.0  # HTTP库，requests依赖，放宽版本范围
certifi>=2023.0.0  # SSL证书，HTTP请求容错，定期更新

# ==================== 环境变量和配置管理 ====================
python-dotenv>=1.0.0,<3.0.0  # .env文件支持，放宽版本范围

# ==================== RSS解析和定时任务 ====================
feedparser>=6.0.0,<8.0.0  # RSS/Atom源解析，放宽版本范围
schedule>=1.2.0,<3.0.0  # 定时任务调度，放宽版本范围

# ==================== WebSocket 和异步通信 ====================
websockets>=12.0,<14.0  # WebSocket客户端/服务器，用于TTS语音合成功能

# ==================== 容错和重试机制 ====================
tenacity>=8.2.0,<10.0.0  # 重试装饰器库，提供多种重试策略，增强容错性
backoff>=2.2.0,<3.0.0  # 指数退避重试库，HTTP请求容错备用方案
retry>=0.9.2,<1.0.0  # 简单重试装饰器，轻量级容错方案

# ==================== 异常处理和日志增强 ====================
exceptiongroup>=1.1.0,<2.0.0  # 异常组支持，Python 3.11+兼容，向后兼容（Python 3.10需要此包）

# ==================== 邮件发送支持（可选）====================
# 如果需要邮件功能，确保已配置SMTP服务器
# email  # Python标准库，无需单独安装

# ==================== 数据验证和类型检查（可选，增强容错） ====================
# pydantic>=2.0.0,<3.0.0  # 数据验证库，可选，用于API参数验证

# ==================== 工具库（提高系统稳定性） ====================
packaging>=23.0,<25.0  # 版本解析工具，pip依赖，显式声明提高容错
setuptools>=68.0.0  # 包管理工具，pip依赖，显式声明
wheel>=0.40.0  # 构建工具，pip依赖，显式声明提高容错
tqdm>=4.65.0,<5.0.0  # 进度条显示库，用于视频生成等任务的进度显示

# ==================== 数据库支持（如果需要） ====================
# SQLAlchemy>=2.0.0,<3.0.0  # ORM框架
# sqlite3  # Python标准库，无需单独安装

# ==================== 开发依赖（可选） ====================
# pytest>=7.0.0,<8.0.0  # 测试框架
# black>=23.0.0,<24.0.0  # 代码格式化
# flake8>=6.0.0,<7.0.0  # 代码检查
# mypy>=1.0.0,<2.0.0  # 类型检查

# ==================== 安装说明 ====================
# 1. 确保Python版本 >=3.10（推荐使用 Python 3.10, 3.11, 3.12 或 3.13）
#    检查版本：python --version 或 python3 --version
# 2. 创建并激活虚拟环境（强烈推荐）：
#    python -m venv venv
#    # Windows (PowerShell):
#    venv\Scripts\Activate.ps1
#    # Windows (CMD):
#    venv\Scripts\activate.bat
#    # Linux/Mac:
#    source venv/bin/activate
# 3. 更新pip和构建工具（提高容错性）：
#    python -m pip install --upgrade pip setuptools wheel
# 4. 安装依赖（推荐使用 install.bat 脚本，可避免命令行长度限制）：
#    # 方式1：使用安装脚本（Windows推荐）
#    install.bat
#    # 方式2：直接使用pip（如果遇到命令过长的问题，请使用方式1）
#    pip install -r requirements.txt
#    如果遇到依赖冲突或安装失败，可以尝试：
#    - 升级pip: pip install --upgrade pip
#    - 清理缓存: pip cache purge
#    - 无缓存安装: pip install -r requirements.txt --no-cache-dir
#    - 使用国内镜像（如需要）:
#      pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
# 5. 配置环境变量：
#    复制 env.example 为 .env 并填入必要的API密钥
# 6. 初始化数据库（如果需要）：
#    python database/db_init.py
# 7. 运行应用：
#    python app.py

# ==================== 容错说明 ====================
# - Python版本要求: py3.10+ (Python >= 3.10)，推荐 3.10, 3.11, 3.12, 3.13
# - 所有依赖使用 >= 而非 ==，允许自动获取安全更新和bug修复
# - 版本上限设置宽松，避免依赖链冲突，提高容错性
# - 包含必要的间接依赖，提高安装成功率
# - 支持Python 3.10, 3.11, 3.12, 3.13等版本
# - 添加了多个重试库（tenacity, backoff, retry），提供多种容错策略
# - 显式声明了pip依赖（packaging, setuptools, wheel），提高安装稳定性
# - 所有版本范围都经过Python 3.10+兼容性验证
# - 使用宽松的版本范围格式（>=下限,<上限），最大化容错性
# - exceptiongroup 包确保 Python 3.10 也能使用异常组功能（Python 3.11+原生支持）
# - 所有依赖都支持向后兼容，确保在不同Python 3.10+版本间平滑迁移

# ==================== 故障排除 ====================
# 如果安装失败，尝试以下步骤（按顺序尝试）：
# 1. 检查Python版本: python --version (需要 >= 3.10)
#    如果版本过低，请升级Python或使用pyenv等工具管理多版本
# 2. 升级pip和构建工具:
#    python -m pip install --upgrade pip setuptools wheel
# 3. 清理pip缓存:
#    pip cache purge
# 4. 使用国内镜像源（如需要，提高下载速度）:
#    pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
#    或使用阿里云镜像: -i https://mirrors.aliyun.com/pypi/simple/
# 5. 无缓存安装（避免使用损坏的缓存）:
#    pip install -r requirements.txt --no-cache-dir
# 6. 分步安装（定位问题依赖）:
#    先安装基础依赖: pip install Flask flask-cors python-dotenv
#    再安装其他依赖: pip install -r requirements.txt
# 7. 检查虚拟环境（确保在正确的环境中安装）:
#    which python  # Linux/Mac
#    where python  # Windows
# 8. 如果仍有问题，尝试使用更宽松的版本约束:
#    临时修改requirements.txt，移除版本上限（不推荐，仅用于测试）
# 9. 查看详细错误信息:
#    pip install -r requirements.txt -v  # 详细输出
#    pip install -r requirements.txt --log install.log  # 保存日志

